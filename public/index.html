<!DOCTYPE html>
<html>
  <head>
    <title>Group 5 - MM802 Mini Project</title>
    <meta charset="utf-8">
    <style>
        body {
            float: left;
            height: 100%;
            width: 100%;
            margin: 0;
        }
        #baguazhen {
            display: block;
            position: absolute;
            height: 100%;
            width: 100%;
            top: 0;
            z-index: 2;
        }
        #map {
            display: inline-block;
            height: 100vh;
            width: 100%;
        }
    </style>
  </head>
  <body>
    <div id="baguazhen" style="height: 100vh"></div>
    <div id="map"></div>

    <script type="text/javascript"
        src="https://maps.googleapis.com/maps/api/js?key=AIzaSyCLg0cOyioggM7H2rlPNsyf_y_eENk1Ct0&libraries=places">
    </script>


    <script type="text/javascript" src="./jquery.js"></script>
    <script type="text/javascript" src="./echarts.js"></script>
    <script type="text/javascript" src="./baguazhen.js"></script>
    <script>
        var map;
        var service;
        var markers;

        function getLocation() {
            if (navigator.geolocation) {
                navigator.geolocation.getCurrentPosition(initMap);
            } else {
                x.innerHTML = "Geolocation is not supported by this browser.";
            }
        }

        function callback(results, status) {
            console.log(results);
            if (status == google.maps.places.PlacesServiceStatus.OK) {
                for (var i = 0, place; place = results[i]; i++) {
                    var lat = place.geometry.location.lat();
                    var lng = place.geometry.location.lng();

                    new google.maps.Marker({
                        position: {lat: lat, lng: lng},
                        map: map
                    });
                }
            }
        }

        function initMap(position) {
            var location = {lat: 53.5232189, lng: -113.5285073}; // u of a
            if (position) {
                location = {lat: position.coords.latitude, lng: position.coords.longitude};
            }

            map = new google.maps.Map(document.getElementById('map'), {
                zoom: 15,
                center: location
            });

            var marker = new google.maps.Marker({
                position: location,
                map: map
            });

            var nearBySearchReq = {
                location: new google.maps.LatLng(position.coords.latitude, position.coords.longitude),
                radius: '500',
                type: ['restaurant'],
                keyword: ['japanese']
            };

            var textSearchReq = {
                location: new google.maps.LatLng(position.coords.latitude, position.coords.longitude),
                radius: '500',
                query: 'japanese',
                type: ['restaurant'],
            };

            service = new google.maps.places.PlacesService(map);
            // service.nearbySearch(nearBySearchReq, callback);
            service.textSearch(textSearchReq, callback);
        }

        getLocation();
    </script>
    <script>
        $(document).keyup(function(e) {
            if (e.keyCode == 27) { // esc pressed
                console.log('esc pressed');
                $("#baguazhen").toggle();
            }
        });
    </script>
  </body>
</html>